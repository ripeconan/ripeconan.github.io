
 <!DOCTYPE HTML>
<html >
<head>
  <meta charset="UTF-8">
  
    <title>apply系列函数简介 | ripeconan</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="ripeconan">
    

    
    <meta name="description" content="R语言中的apply系列函数功能强大, 能够有效的减少显式循环. 本文介绍其中的一部分.
apply, lapply, sapply, tapply, vapply, mapply
applyapply函数是最该系列中最基础的一个, 使用方法:

apply(X, MARGIN, FUN, …)
输入X为数组和矩阵, 平时矩阵使用地更频繁一些, 也更容易理解
MARGIN, 可以等于 1 或者 2">
<meta property="og:type" content="article">
<meta property="og:title" content="apply系列函数简介">
<meta property="og:url" content="http://ripeconan.com/2016/05/01/apply/index.html">
<meta property="og:site_name" content="ripeconan">
<meta property="og:description" content="R语言中的apply系列函数功能强大, 能够有效的减少显式循环. 本文介绍其中的一部分.
apply, lapply, sapply, tapply, vapply, mapply
applyapply函数是最该系列中最基础的一个, 使用方法:

apply(X, MARGIN, FUN, …)
输入X为数组和矩阵, 平时矩阵使用地更频繁一些, 也更容易理解
MARGIN, 可以等于 1 或者 2">
<meta property="og:updated_time" content="2016-05-01T06:53:55.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="apply系列函数简介">
<meta name="twitter:description" content="R语言中的apply系列函数功能强大, 能够有效的减少显式循环. 本文介绍其中的一部分.
apply, lapply, sapply, tapply, vapply, mapply
applyapply函数是最该系列中最基础的一个, 使用方法:

apply(X, MARGIN, FUN, …)
输入X为数组和矩阵, 平时矩阵使用地更频繁一些, 也更容易理解
MARGIN, 可以等于 1 或者 2">

    
    <link rel="alternative" href="/atom.xml" title="ripeconan" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="ripeconan" title="ripeconan"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="ripeconan">ripeconan</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜單">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:ripeconan.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2016/05/01/apply/" title="apply系列函数简介" itemprop="url">apply系列函数简介</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="ripeconan" target="_blank" itemprop="author">ripeconan</a>
		
  <p class="article-time">
    <time datetime="2016-04-30T16:00:00.000Z" itemprop="datePublished"> 發表於 2016-05-01</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目錄</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#apply"><span class="toc-number">1.</span> <span class="toc-text">apply</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lapply__u548C_sapply__u4EE5_u53CA_vapply"><span class="toc-number">2.</span> <span class="toc-text">lapply 和 sapply 以及 vapply</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lapply"><span class="toc-number">2.1.</span> <span class="toc-text">lapply</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sapply"><span class="toc-number">2.2.</span> <span class="toc-text">sapply</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vapply"><span class="toc-number">2.3.</span> <span class="toc-text">vapply</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapply"><span class="toc-number">3.</span> <span class="toc-text">mapply</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tapply"><span class="toc-number">4.</span> <span class="toc-text">tapply</span></a></li></ol>
		
		</div>
		
		<p>R语言中的apply系列函数功能强大, 能够有效的减少显式循环. 本文介绍其中的一部分.</p>
<p>apply, lapply, sapply, tapply, vapply, mapply</p>
<h2 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h2><p>apply函数是最该系列中最基础的一个, 使用方法:</p>
<ul>
<li>apply(X, MARGIN, FUN, …)</li>
<li>输入X为数组和矩阵, 平时矩阵使用地更频繁一些, 也更容易理解</li>
<li>MARGIN, 可以等于 1 或者 2, 分别指代对行做操作, 还是对列做操作</li>
<li>FUN, 对X的行或者列做什么操作, 可以调用R自带函数, 也可以自己编写函数</li>
<li>FUN如果返回单个数字(这也是最常见的), 则apply返回的是一个向量</li>
<li>FUN如果返回一个长度为n的向量, 则apply返回的是一个矩阵</li>
</ul>
<p>这里需要先说明一下: apply系列函数中一般都会含有一个FUN参数, 根据实际问题不同, 这个FUN函数可以很复杂, 因此一般是自己编写的函数, 而应该传递给该FUN函数的参数, 就放到后面的 “…” 中(之后在使用方法中不再列出”…”的说明). 接下来通过实例可以看出如何使用FUN参数来实现自己的目标.</p>
<p>以下生成了具有30行2列的一个矩阵x, 可以认为是30个人的身高(单位cm)和体重(单位kg)数据, 我们想求这30个人的平均身高和平均体重, 那么就要对每一列求均值, 这就用到了apply函数.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set.seed(<span class="number">1234</span>)</span><br><span class="line">x &lt;- cbind(height = rnorm(<span class="number">30</span>, <span class="number">170</span>, <span class="number">10</span>), weight = rnorm(<span class="number">30</span>, <span class="number">60</span>, <span class="number">5</span>))</span><br><span class="line">class(x)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="string">"matrix"</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head(x)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##        height   weight</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>,] <span class="number">157.9293</span> <span class="number">65.51149</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">2</span>,] <span class="number">172.7743</span> <span class="number">57.62203</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">3</span>,] <span class="number">180.8444</span> <span class="number">56.45280</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">4</span>,] <span class="number">146.5430</span> <span class="number">57.49371</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">5</span>,] <span class="number">174.2912</span> <span class="number">51.85453</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">6</span>,] <span class="number">175.0606</span> <span class="number">54.16190</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply(x, MARGIN = <span class="number">2</span>, mean)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##    height    weight </span></span><br><span class="line"><span class="preprocessor">## <span class="number">167.03575</span>  <span class="number">57.24191</span></span></span><br></pre></td></tr></table></figure>
<p>如果想求每个人的BMI指数(体重(kg)除以身高(m)的平方, 即$kg/m^2$), 你会发现R中并无直接可以调用的函数, 于是需要自己编写自定义函数并赋给apply的FUN参数了</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bmi &lt;- <span class="keyword">function</span>(data)&#123;</span><br><span class="line">  height &lt;- data[<span class="number">1</span>]/<span class="number">100</span></span><br><span class="line">  weight &lt;- data[<span class="number">2</span>]</span><br><span class="line">  <span class="keyword">return</span>(weight/(height^<span class="number">2</span>))</span><br><span class="line">&#125;</span><br><span class="line">bmindex &lt;- apply(x, MARGIN = <span class="number">1</span>, FUN = bmi)</span><br><span class="line">length(bmindex)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">30</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head(bmindex)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">26.26587</span> <span class="number">19.30325</span> <span class="number">17.26137</span> <span class="number">26.77257</span> <span class="number">17.07008</span> <span class="number">17.67329</span></span></span><br></pre></td></tr></table></figure>
<p>我们也可以把计算出的BMI指数赋给矩阵的第三列.</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x &lt;- cbind(x, bmindex)</span><br></pre></td></tr></table></figure>
<p>在刚才的例子中, 编写的bmi函数只需要传进来一个长度为 2 的向量(分别为身高和体重数据)即可, 而这正好对应了矩阵的一行数据. 因此并不需要更多参数就能完成BMI的计算.</p>
<p>如果除了BMI之外, 任务中还要计算其他量, 则可以一起写进函数中, 并传递给apply函数的FUN参数, 只不过此时apply函数也会返回一个矩阵了. 由于此种用法不多, 我们就不再赘述, 有需要的请看帮助文件.</p>
<h2 id="lapply__u548C_sapply__u4EE5_u53CA_vapply"><a href="#lapply__u548C_sapply__u4EE5_u53CA_vapply" class="headerlink" title="lapply 和 sapply 以及 vapply"></a>lapply 和 sapply 以及 vapply</h2><p>这三个放到一起说, 是因为其本质功能是类似的, 只不过稍有差别.<br>下面按序介绍</p>
<h3 id="lapply"><a href="#lapply" class="headerlink" title="lapply"></a>lapply</h3><ul>
<li>lapply(X, FUN, …)</li>
<li>输入X为列表或向量, 但是大多数情况是列表</li>
<li>FUN, 当X是列表时, 对X的每个元素做什么操作. 可以调用R自带函数, 也可以自己编写函数</li>
<li>lapply返回值仍然是一个列表, 且元素个数和X相等</li>
</ul>
<p>这里注意一点: 使用列表作为数据结构来存储数据, 本来就是因为数据具有异质性且可能长度不同(普通的异质性如果长度相同的话可以使用数据框, 如姓名, 性别, 身高等等), 那么lapply的FUN参数就要放一个能够对长度不同的异质性数据都可操作的函数. 这样的函数在R里自带的并不多, 大都需要自己编写.</p>
<p>先举一个帮助文件里的例子:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xl &lt;- list(a = <span class="number">1</span>:<span class="number">10</span>, beta = exp(-<span class="number">3</span>:<span class="number">3</span>), logic = c(<span class="literal">TRUE</span>,<span class="literal">FALSE</span>,<span class="literal">FALSE</span>,<span class="literal">TRUE</span>))</span><br><span class="line">xl</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">##  [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $beta</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>]  <span class="number">0.04978707</span>  <span class="number">0.13533528</span>  <span class="number">0.36787944</span>  <span class="number">1.00000000</span>  <span class="number">2.71828183</span>  <span class="number">7.38905610</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">7</span>] <span class="number">20.08553692</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $logic</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>]  TRUE FALSE FALSE  TRUE</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lapply(xl, mean)</span><br></pre></td></tr></table></figure>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">## [1] 5.5</span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $beta</span></span><br><span class="line"><span class="preprocessor">## [1] 4.535125</span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $logic</span></span><br><span class="line"><span class="preprocessor">## [1] 0.5</span></span><br></pre></td></tr></table></figure>
<p>由上述代码运行结果可以看出, xl是一个拥有三个元素的列表, 每个元素都是长度不同(分别是10, 7, 4)且异质的数据(分别为integer, numeric, logical). 上述论断其实也可以通过lapply来得出结果. 求xl的每个元素的长度, 相当于对列表的每个元素运行length函数(如果直接运行length(xl), 你一定不会得到想要的结果)</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lapply(xl, length)</span><br></pre></td></tr></table></figure>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">## [1] 10</span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $beta</span></span><br><span class="line"><span class="preprocessor">## [1] 7</span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $logic</span></span><br><span class="line"><span class="preprocessor">## [1] 4</span></span><br></pre></td></tr></table></figure>
<p>想要知道xl的每个元素的数据类型, 相当于对列表的每个元素运行class函数</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lapply(xl, class)</span><br></pre></td></tr></table></figure>
<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">## [1] "integer"</span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $beta</span></span><br><span class="line"><span class="preprocessor">## [1] "numeric"</span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $logic</span></span><br><span class="line"><span class="preprocessor">## [1] "logical"</span></span><br></pre></td></tr></table></figure>
<p>最后, 我们在例子中使用的是: 对列表的每个元素运行mean函数. 这样做可以得到正确的结果是因为, integer, numeric, logical 这三种数据类型, 本质上还是数字(logical存储为0和1), 是可以进行求均值的操作的. 正是由于均为数字, 因此求分位数也是可以的. 下面我们再引用一个帮助文档中的例子, 重点说明参数列表中的”…”如何使用:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lapply(xl, quantile, probs = <span class="number">1</span>:<span class="number">3</span>/<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">##  <span class="number">25</span>%  <span class="number">50</span>%  <span class="number">75</span>% </span></span><br><span class="line"><span class="preprocessor">## <span class="number">3.25</span> <span class="number">5.50</span> <span class="number">7.75</span> </span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $beta</span></span><br><span class="line"><span class="preprocessor">##       <span class="number">25</span>%       <span class="number">50</span>%       <span class="number">75</span>% </span></span><br><span class="line"><span class="preprocessor">## <span class="number">0.2516074</span> <span class="number">1.0000000</span> <span class="number">5.0536690</span> </span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $logic</span></span><br><span class="line"><span class="preprocessor">## <span class="number">25</span>% <span class="number">50</span>% <span class="number">75</span>% </span></span><br><span class="line"><span class="preprocessor">## <span class="number">0.0</span> <span class="number">0.5</span> <span class="number">1.0</span></span></span><br></pre></td></tr></table></figure>
<p>注意到probs参数在lapply的调用中, 就是处于”…”的位置, 因此probs参数事实上是传递给quantile的. 那么这句代码做的事情就可以翻译为: 对列表xl的每一个元素, 计算其下四分位数, 中位数, 上四分位数. </p>
<p>如果”…”这里需要传递进来的参数不止一个, 那么只要用逗号隔开即可. 这里放多少个参数都无所谓, 最后都是传给FUN的.</p>
<h3 id="sapply"><a href="#sapply" class="headerlink" title="sapply"></a>sapply</h3><p>sapply和lapply的关系有点类似于read.csv和read.table的关系.<br>read.csv只是read.table把某些参数固定后的定制版. sapply的功能也是基于lapply修改而成的. </p>
<ul>
<li>使用方法: sapply(X, FUN, …, simplify = TRUE, USE.NAMES = TRUE)</li>
<li>使用情形: 当lapply对每个元素的计算结果均为长度相等的向量时, 我们想要把这些元素以更加整齐的方式组织起来</li>
<li>simplify = TRUE, 即默认把这些计算结果组织成向量(当每个元素的计算结果长度为1时)或矩阵(当每个元素的计算结果长度大于1时)</li>
<li>USE.NAMES = TRUE, 用处不是很大, 可以暂时不用管</li>
</ul>
<p>为了说明sapply的使用情形和方法, 并与lapply函数作比较, 我们仍然沿用上面lapply中的例子</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xl</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">##  [<span class="number">1</span>]  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>  <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $beta</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>]  <span class="number">0.04978707</span>  <span class="number">0.13533528</span>  <span class="number">0.36787944</span>  <span class="number">1.00000000</span>  <span class="number">2.71828183</span>  <span class="number">7.38905610</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">7</span>] <span class="number">20.08553692</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $logic</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>]  TRUE FALSE FALSE  TRUE</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lapply(xl, quantile, probs = <span class="number">1</span>:<span class="number">3</span>/<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">##  <span class="number">25</span>%  <span class="number">50</span>%  <span class="number">75</span>% </span></span><br><span class="line"><span class="preprocessor">## <span class="number">3.25</span> <span class="number">5.50</span> <span class="number">7.75</span> </span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $beta</span></span><br><span class="line"><span class="preprocessor">##       <span class="number">25</span>%       <span class="number">50</span>%       <span class="number">75</span>% </span></span><br><span class="line"><span class="preprocessor">## <span class="number">0.2516074</span> <span class="number">1.0000000</span> <span class="number">5.0536690</span> </span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $logic</span></span><br><span class="line"><span class="preprocessor">## <span class="number">25</span>% <span class="number">50</span>% <span class="number">75</span>% </span></span><br><span class="line"><span class="preprocessor">## <span class="number">0.0</span> <span class="number">0.5</span> <span class="number">1.0</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sapply(xl, quantile, probs = <span class="number">1</span>:<span class="number">3</span>/<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##        a      beta logic</span></span><br><span class="line"><span class="preprocessor">## <span class="number">25</span>% <span class="number">3.25</span> <span class="number">0.2516074</span>   <span class="number">0.0</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">50</span>% <span class="number">5.50</span> <span class="number">1.0000000</span>   <span class="number">0.5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">75</span>% <span class="number">7.75</span> <span class="number">5.0536690</span>   <span class="number">1.0</span></span></span><br></pre></td></tr></table></figure>
<p>注意到lapply函数中的quantile对列表xl的每个元素都会得到长度为3的计算结果(分别是三个分位数). 由于计算结果长度相等, 所以我们可以把它们以更加整齐的方式组织起来(在这里, 是以一个矩阵的方式), 于是使用sapply会得到同样的计算结果, 但是格式上更加”user-friendly”(按帮助文档的叫法).</p>
<p>事实上, 如果是普通的统计函数的话, 函数返回值经常会和输入数据长度没任何关系. 比如mean函数, 无论传进来的向量多长, 返回的总是一个数. 上面举例的quantile函数也是如此. 那么这种计算结果, 就可以被整理成整齐的格式, 也就是说, 我们可以使用sapply去处理. 反之, 如果一个函数的输入长度与计算结果相关, 那么还得使用lapply(经过测试, 此时使用sapply也没用, 系统还是会调用lapply的). 我们可以通过一个简单的例子来说明: </p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">difflength &lt;- list(a = <span class="number">1</span>:<span class="number">2</span>, b = <span class="number">1</span>:<span class="number">3</span>)</span><br><span class="line">calc.seq &lt;- <span class="keyword">function</span>(data)&#123;</span><br><span class="line">  seq(min(data), max(data), by = <span class="number">0.5</span>)</span><br><span class="line">&#125;</span><br><span class="line">lapply(difflength, calc.seq)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1.0</span> <span class="number">1.5</span> <span class="number">2.0</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $b</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1.0</span> <span class="number">1.5</span> <span class="number">2.0</span> <span class="number">2.5</span> <span class="number">3.0</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sapply(difflength, calc.seq)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## $a</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1.0</span> <span class="number">1.5</span> <span class="number">2.0</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## $b</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1.0</span> <span class="number">1.5</span> <span class="number">2.0</span> <span class="number">2.5</span> <span class="number">3.0</span></span></span><br></pre></td></tr></table></figure>
<p>上述代码可以看到, sapply并没有返回一个矩阵, 这是因为对于difflength的不同元素, calc.seq的计算结果是不同的, 所以sapply仍然只能作为列表返回, 那么这就和lapply是相同的功能了.</p>
<p>不管怎么说, 能用sapply的地方还是用sapply, 能返回向量和矩阵的, 就不要返回列表.</p>
<h3 id="vapply"><a href="#vapply" class="headerlink" title="vapply"></a>vapply</h3><ul>
<li>使用方法: vapply(X, FUN, FUN.VALUE, …, USE.NAMES = TRUE)</li>
<li>和sapply的相同之处: 仍然是对列表每个元素调用FUN, 并返回一个向量和矩阵</li>
<li>和sapply的不用之处: 返回矩阵时, 给每个元素起好了名字, 于是矩阵就有了行名</li>
</ul>
<p>vapply的用处并不是很大, 于是直接拿帮助文档的例子展示一下即可:</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i39 &lt;- sapply(<span class="number">3</span>:<span class="number">9</span>, seq) <span class="comment"># list of vectors</span></span><br><span class="line">sapply(i39, fivenum)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##      [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>] [,<span class="number">5</span>] [,<span class="number">6</span>] [,<span class="number">7</span>]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>,]  <span class="number">1.0</span>  <span class="number">1.0</span>    <span class="number">1</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>    <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">2</span>,]  <span class="number">1.5</span>  <span class="number">1.5</span>    <span class="number">2</span>  <span class="number">2.0</span>  <span class="number">2.5</span>  <span class="number">2.5</span>    <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">3</span>,]  <span class="number">2.0</span>  <span class="number">2.5</span>    <span class="number">3</span>  <span class="number">3.5</span>  <span class="number">4.0</span>  <span class="number">4.5</span>    <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">4</span>,]  <span class="number">2.5</span>  <span class="number">3.5</span>    <span class="number">4</span>  <span class="number">5.0</span>  <span class="number">5.5</span>  <span class="number">6.5</span>    <span class="number">7</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">5</span>,]  <span class="number">3.0</span>  <span class="number">4.0</span>    <span class="number">5</span>  <span class="number">6.0</span>  <span class="number">7.0</span>  <span class="number">8.0</span>    <span class="number">9</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vapply(i39, fivenum,</span><br><span class="line">       c(Min. = <span class="number">0</span>, <span class="string">"1st Qu."</span> = <span class="number">0</span>, Median = <span class="number">0</span>, <span class="string">"3rd Qu."</span> = <span class="number">0</span>, Max. = <span class="number">0</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##         [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>] [,<span class="number">4</span>] [,<span class="number">5</span>] [,<span class="number">6</span>] [,<span class="number">7</span>]</span></span><br><span class="line"><span class="preprocessor">## Min.     <span class="number">1.0</span>  <span class="number">1.0</span>    <span class="number">1</span>  <span class="number">1.0</span>  <span class="number">1.0</span>  <span class="number">1.0</span>    <span class="number">1</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">1</span>st Qu.  <span class="number">1.5</span>  <span class="number">1.5</span>    <span class="number">2</span>  <span class="number">2.0</span>  <span class="number">2.5</span>  <span class="number">2.5</span>    <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## Median   <span class="number">2.0</span>  <span class="number">2.5</span>    <span class="number">3</span>  <span class="number">3.5</span>  <span class="number">4.0</span>  <span class="number">4.5</span>    <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## <span class="number">3</span>rd Qu.  <span class="number">2.5</span>  <span class="number">3.5</span>    <span class="number">4</span>  <span class="number">5.0</span>  <span class="number">5.5</span>  <span class="number">6.5</span>    <span class="number">7</span></span></span><br><span class="line"><span class="preprocessor">## Max.     <span class="number">3.0</span>  <span class="number">4.0</span>    <span class="number">5</span>  <span class="number">6.0</span>  <span class="number">7.0</span>  <span class="number">8.0</span>    <span class="number">9</span></span></span><br></pre></td></tr></table></figure>
<p>以上代码可以看出, vapply和sapply一样, 都返回了一个矩阵, 只不过sapply的矩阵没有行名, 而vapply专门指定了行名. 其实给矩阵的行命名是一件容易的事情, 所以没有必要为此多记一个函数(apply系列函数实在太多, 区分是很困难的, 能少记一个就少记一个吧). 另外, 上面的i39变量的赋值正好是sapply对向量(通常都是对列表)的隐式循环调用, 可以从中看到sapply的第一个参数为向量时, 是如何计算的. </p>
<h2 id="mapply"><a href="#mapply" class="headerlink" title="mapply"></a>mapply</h2><p>使用方法: </p>
<p>mapply(FUN, …, MoreArgs = NULL, SIMPLIFY = TRUE,<br>       USE.NAMES = TRUE)</p>
<p>mapply是sapply的多维版本. 什么叫做多维版本呢? 回顾一下上一节的最后, sapply的第一个参数为向量的例子</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sapply(<span class="number">3</span>:<span class="number">9</span>, seq)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [[<span class="number">1</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## [[<span class="number">2</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## [[<span class="number">3</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## [[<span class="number">4</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## [[<span class="number">5</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## [[<span class="number">6</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## [[<span class="number">7</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></span></span><br></pre></td></tr></table></figure>
<p>我们可以认为上一行代码是将seq循环调用到3至9这几个数字上. 3:9的这个向量的每一个分量, 其实就是作为seq的”一个”参数依次传进来, 此时传进来的参数维度为 1. 如果给seq传进来两个参数, 并且这两个参数都是依照不同向量的分量依次传进来呢? 我们就需要R语言中的循环法则了, 这个时候传进来的参数维度就是多维的了. </p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mapply(seq,<span class="number">1</span>:<span class="number">3</span>,c(<span class="number">4</span>,<span class="number">6</span>,<span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [[<span class="number">1</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## [[<span class="number">2</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span></span><br><span class="line"><span class="preprocessor">## </span></span><br><span class="line"><span class="preprocessor">## [[<span class="number">3</span>]]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span></span><br></pre></td></tr></table></figure>
<p>如上例所示, mapply调用的函数是序列生成函数seq, 后面的1:3, c(4,6,5)均是传到seq的参数, 这就可以看做是sapply的二维版本.</p>
<p>在参数传递的过程中, 特别需要注意的是, 1:3和c(4,6,5)的长度都是3, 是相等的, 那么按照R的循环法则, 此时两个向量的第一个分量同时传入seq, 那么函数执行的是</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seq(<span class="number">1</span>,<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span></span></span><br></pre></td></tr></table></figure>
<p>接下来循环到第二个和第三个分量时, 函数又分别调用了两次, 执行的是</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seq(<span class="number">2</span>,<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span> <span class="number">6</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seq(<span class="number">3</span>,<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">## [<span class="number">1</span>] <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span></span><br></pre></td></tr></table></figure>
<p>最后mapply返回的是一个列表(一般情况下循环调用了FUN, 可以认为每次返回值不必都相等). 在特殊情况下, 由于默认的 <strong>SIMPLIFY = TRUE</strong>, 那么返回值是可以尽可能的合并成一个格式整齐的矩阵的. 比如</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mapply(seq, <span class="number">1</span>:<span class="number">3</span>,<span class="number">4</span>:<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##      [,<span class="number">1</span>] [,<span class="number">2</span>] [,<span class="number">3</span>]</span></span><br><span class="line"><span class="preprocessor">## [<span class="number">1</span>,]    <span class="number">1</span>    <span class="number">2</span>    <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">2</span>,]    <span class="number">2</span>    <span class="number">3</span>    <span class="number">4</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">3</span>,]    <span class="number">3</span>    <span class="number">4</span>    <span class="number">5</span></span></span><br><span class="line"><span class="preprocessor">## [<span class="number">4</span>,]    <span class="number">4</span>    <span class="number">5</span>    <span class="number">6</span></span></span><br></pre></td></tr></table></figure>
<p>综上, mapply使用的场景主要为, 我们要对某个具有多个参数的函数进行不同参数取值的多次调用. 其余可以参见帮助文档.</p>
<h2 id="tapply"><a href="#tapply" class="headerlink" title="tapply"></a>tapply</h2><p>使用方法:</p>
<p>tapply(X, INDEX, FUN = NULL, …, simplify = TRUE)</p>
<ul>
<li>函数形式 tapply(x,INDEX,FUN=f)</li>
<li>其中 x 是向量 , INDEX 是一个因子 , 且需要和 x 的长度一样</li>
<li>将函数 f, 按照 INDEX 的分类的角标 , 对 x 操作</li>
</ul>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fac &lt;- factor(rep(<span class="number">1</span>:<span class="number">3</span>, <span class="number">4</span>), levels = <span class="number">1</span>:<span class="number">5</span>)</span><br><span class="line">fac</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##  [<span class="number">1</span>] <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span></span><br><span class="line"><span class="preprocessor">## Levels: <span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span> <span class="number">5</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tapply(<span class="number">1</span>:<span class="number">12</span>, fac, sum)</span><br></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">##  <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span> </span></span><br><span class="line"><span class="preprocessor">## <span class="number">22</span> <span class="number">26</span> <span class="number">30</span> NA NA</span></span><br></pre></td></tr></table></figure>
<p>如上, fac变量为一个因子, 并与1:12的长度相等, 都为12. tapply函数对1:12这个向量, 按照因子fac的分组顺序进行分组, 然后对每组进行FUN = sum的操作. 具体请参见帮助文档.</p>
  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/R/">R</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/R-函数/">R 函数</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://ripeconan.com/2016/05/01/apply/" data-title="apply系列函数简介 | ripeconan" data-tsina="null" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 

<div class="next">
<a href="/2016/01/19/svm/"  title="支持向量机的kernlab::ksvm实现">
 <strong>下一篇：</strong><br/> 
 <span>支持向量机的kernlab::ksvm实现
</span>
</a>
</div>

</nav>

	

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="顯示側邊欄"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目錄</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#apply"><span class="toc-number">1.</span> <span class="toc-text">apply</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#lapply__u548C_sapply__u4EE5_u53CA_vapply"><span class="toc-number">2.</span> <span class="toc-text">lapply 和 sapply 以及 vapply</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#lapply"><span class="toc-number">2.1.</span> <span class="toc-text">lapply</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sapply"><span class="toc-number">2.2.</span> <span class="toc-text">sapply</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#vapply"><span class="toc-number">2.3.</span> <span class="toc-text">vapply</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mapply"><span class="toc-number">3.</span> <span class="toc-text">mapply</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tapply"><span class="toc-number">4.</span> <span class="toc-text">tapply</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隱藏側邊欄"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分類</p>
		<ul>
		
		  
			<li><a href="/categories/Empirical-Likelihood/" title="Empirical Likelihood">Empirical Likelihood<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Learning/" title="Learning">Learning<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/Machine-Learning/" title="Machine Learning">Machine Learning<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/R/" title="R">R<sup>9</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">標簽</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/R-programing/" title="R programing">R programing<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/R-函数/" title="R 函数">R 函数<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/To-Do/" title="To Do">To Do<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/data-mining/" title="data mining">data mining<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/R-package/" title="R package">R package<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/algorithms/" title="algorithms">algorithms<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情鏈接</p>
    <ul>
        
          <li>
            
            	<a href="http://zjdian.com/" target="_blank" title="中继点">中继点</a>
            
          </li>
        
          <li>
            
            	<a href="http://blog.fens.me/" target="_blank" title="粉丝日志">粉丝日志</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 訂閱</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	
	<section class="info">
		<p> Design your life, Build your dream. <br/>
			     </p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="ripeconan">ripeconan</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>





<!-- Analytics Begin -->



<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fe6d1f421bbc9962127a50488f9ed37d1' type='text/javascript'%3E%3C/script%3E"));
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回頂部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
